<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Polícia Militar - Busca de Natureza (POP)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
/* =========================
   IDENTIDADE VISUAL PM
   ========================= */
:root{
  --pm-blue:#1f3a5f;
  --pm-blue-dark:#142640;
  --pm-focus:#0d6efd;
  --pm-bg:#f0f2f5;
  --pm-border:#d0d7de;
}

body{
  background: var(--pm-bg);
  font-family: "Segoe UI", Tahoma, Arial, sans-serif;
  min-height: 100vh;
}

/* HEADER */
.pm-header{
  background: var(--pm-blue);
  color: #fff;
  height: 64px;
  display: flex;
  align-items: center;
  padding: 0 24px;
  box-shadow: 0 2px 10px rgba(0,0,0,.25);
}

.pm-header h1{
  font-size: 1.25rem;
  font-weight: 700;
  margin: 0;
}

.pm-header span{
  font-size: .8rem;
  background: rgba(255,255,255,.15);
  padding: 4px 10px;
  border-radius: 4px;
  margin-left: 12px;
  font-weight: 600;
}

/* CONTEÚDO */
.main-container{
  max-width: 820px;
  margin: 40px auto;
  padding: 0 20px;
}

/* BUSCA */
.search-wrapper{
  position: relative;
}

.search-label{
  font-weight: 700;
  color: var(--pm-blue-dark);
  text-transform: uppercase;
  font-size: .8rem;
  margin-bottom: 6px;
}

.results-list{
  max-height: 320px;
  overflow-y: auto;
  border: 1px solid var(--pm-border);
  border-top: none;
  display: none;
  position: absolute;
  width: 100%;
  background: #fff;
  z-index: 1000;
  box-shadow: 0 10px 20px rgba(0,0,0,.2);
  border-radius: 0 0 8px 8px;
}

.results-list.active{ display:block; }

.result-item{
  padding: 14px 16px;
  border-bottom: 1px solid #eee;
  cursor: pointer;
  font-size: .95rem;
}

.result-item:hover{
  background:#eef5ff;
  color: var(--pm-blue);
  font-weight: 700;
}

/* MODAL POP */
.pop-title-code{
  font-size: 2.2rem;
  font-weight: 800;
  color: var(--pm-blue);
}

.pop-title-text{
  font-size: 1.4rem;
  font-weight: 600;
  color: #444;
}

.pop-box{
  background: #fff;
  border: 1px solid var(--pm-border);
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
}

.pop-label{
  font-size: .75rem;
  font-weight: 700;
  color: #666;
  text-transform: uppercase;
  margin-bottom: 8px;
  display: block;
  letter-spacing: .5px;
}

.pop-actions{
  background: #e3f2fd;
  border-left: 6px solid var(--pm-focus);
}
</style>
</head>

<body>

<!-- HEADER -->
<header class="pm-header">
  <h1>Polícia Militar</h1>
  <span>Busca de Natureza • POP</span>
</header>

<!-- CONTEÚDO -->
<div class="main-container">

  <div class="search-wrapper">
    <label class="search-label">Pesquisar Natureza (POP)</label>
    <input id="nature-input"
           class="form-control form-control-lg border-primary"
           placeholder="Ex: roubo, acidente, ameaça..."
           onkeyup="searchNature(this.value)"
           autocomplete="off">

    <div id="nature-results" class="results-list"></div>
  </div>

</div>

<!-- MODAL FULLSCREEN -->
<div class="modal fade" id="reviewModal" tabindex="-1">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content">

      <div class="modal-header" style="background:var(--pm-blue);color:#fff;">
        <h5 class="modal-title fw-bold">Revisão Obrigatória da Natureza (POP)</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body bg-light">
        <div class="container">

          <div class="text-center mb-4">
            <div class="pop-title-code" id="rev-code">---</div>
            <div class="pop-title-text" id="rev-title">---</div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="pop-box h-100">
                <span class="pop-label">O que caracteriza este fato</span>
                <div id="rev-desc">---</div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="pop-box pop-actions h-100">
                <span class="pop-label text-primary">Ações do Atendente (POP)</span>
                <div class="fw-bold" id="rev-action">---</div>
              </div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
let roteirosData = [];
let reviewModal;

/* INIT */
document.addEventListener('DOMContentLoaded', async ()=>{
  reviewModal = new bootstrap.Modal(document.getElementById('reviewModal'));
  await loadJSON();
});

/* UTIL */
function removeAcentos(str){
  return str.normalize("NFD").replace(/[\u0300-\u036f]/g,"");
}

/* LOAD JSON */
async function loadJSON(){
  try{
    const r = await fetch("roteiros190.json");
    roteirosData = await r.json();
  }catch(e){
    alert("Erro ao carregar o arquivo roteiros190.json");
  }
}

/* BUSCA */
function searchNature(q){
  const list = document.getElementById("nature-results");
  if(q.length < 2){
    list.classList.remove("active");
    return;
  }

  list.innerHTML = "";
  const termo = removeAcentos(q.toLowerCase());

  const matches = roteirosData.filter(i=>{
    const texto = removeAcentos(
      (i.NATUREZA+" "+i.TÍTULO+" "+(i.DESCRIÇÃO||"")).toLowerCase()
    );
    return texto.includes(termo);
  }).slice(0,15);

  if(matches.length === 0){
    list.innerHTML = "<div class='p-3 text-muted'>Nenhum resultado encontrado</div>";
  }else{
    matches.forEach(i=>{
      const div = document.createElement("div");
      div.className = "result-item";
      div.innerHTML = `<span class="badge bg-primary me-2">${i.NATUREZA}</span>${i.TÍTULO}`;
      div.onclick = ()=>openReview(i);
      list.appendChild(div);
    });
  }

  list.classList.add("active");
}

/* MODAL */
function openReview(item){
  document.getElementById("rev-code").innerText = item.NATUREZA;
  document.getElementById("rev-title").innerText = item.TÍTULO;
  document.getElementById("rev-desc").innerText = item.DESCRIÇÃO || "Sem descrição.";
  document.getElementById("rev-action").innerText = item.AÇÕES || "POP padrão.";

  document.getElementById("nature-results").classList.remove("active");
  reviewModal.show();
}
</script>

</body>
</html>


